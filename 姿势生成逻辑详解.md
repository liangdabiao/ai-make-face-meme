# å§¿åŠ¿ç”Ÿæˆé€»è¾‘è¯¦è§£

## ğŸ¯ æ ¸å¿ƒé—®é¢˜å›ç­”

**ä½ é—®ï¼š** å§¿åŠ¿2ï¼Œè¿™äº›å§¿åŠ¿ä»£è¡¨çš„æ˜¯ä»€ä¹ˆï¼Œæ˜¯ä¸åŒçš„æç¤ºè¯­å—ï¼Œå…·ä½“æ€æ ·ï¼Ÿ

**ç­”æ¡ˆï¼š** æ˜¯çš„ï¼è¿™äº›"å§¿åŠ¿"å°±æ˜¯**ä¸åŒçš„æç¤ºè¯­**ï¼Œç”¨æ¥æŒ‡å¯¼AIç”Ÿæˆä¸åŒçš„åŠ¨ä½œçŠ¶æ€ï¼Œå½¢æˆè¿ç»­çš„åŠ¨ç”»æ•ˆæœã€‚

## ğŸ“‹ å§¿åŠ¿æ¨¡æ¿ç³»ç»Ÿ

### 1. åŸºç¡€å§¿åŠ¿æ¨¡æ¿ (`src/lib/ai.ts`)

ç³»ç»Ÿé¢„å®šä¹‰äº†6ç§åŸºç¡€å§¿åŠ¿æ¨¡æ¿ï¼ŒæŒ‰ç…§åœæ ¼åŠ¨ç”»çš„ç»å…¸åŠ¨ä½œé¡ºåºè®¾è®¡ï¼š

```typescript
const poseTemplates = [
  {
    name: "Starting pose",
    description: "Character/object in neutral starting position",
    prompt: "Character in neutral starting position, standing upright with natural posture"
  },
  {
    name: "Initial movement",
    description: "Beginning of animation sequence",
    prompt: "Character beginning to move, slight shift in weight or position"
  },
  {
    name: "Mid action pose",
    description: "Middle point of movement",
    prompt: "Character in the middle of movement, showing progression"
  },
  {
    name: "Peak action",
    description: "Maximum extension or expression",
    prompt: "Character at peak of movement or maximum expression"
  },
  {
    name: "Recovery position",
    description: "Moving back toward starting point",
    prompt: "Character recovering, moving back toward starting position"
  },
  {
    name: "Final pose",
    description: "End of sequence",
    prompt: "Character in final position of the sequence"
  }
];
```

### 2. å§¿åŠ¿ç”Ÿæˆç®—æ³•

```typescript
for (let i = 0; i < numPoses; i++) {
  // å¾ªç¯ä½¿ç”¨å§¿åŠ¿æ¨¡æ¿
  const template = poseTemplates[i % poseTemplates.length];
  const variation = Math.floor(i / poseTemplates.length);

  let poseDescription = template.name;
  let posePrompt = template.prompt;

  // å¦‚æœéœ€è¦è¶…è¿‡6å¸§ï¼Œæ·»åŠ å˜åŒ–
  if (variation > 0) {
    poseDescription += ` (Variation ${variation + 1})`;
    posePrompt += `, variation ${variation + 1}`;
  }

  poses.push({
    name: poseDescription,
    description: template.description,
    prompt: posePrompt,
    step: i + 1
  });
}
```

## ğŸ¬ å…·ä½“ç”Ÿæˆç¤ºä¾‹

### åœºæ™¯ï¼šç”¨æˆ·ä¸Šä¼ ä¸€å¼ äººç‰©ç«™ç«‹çš„ç…§ç‰‡

ç³»ç»Ÿä¼šç”Ÿæˆ12ä¸ªå§¿åŠ¿ï¼Œå¾ªç¯ä½¿ç”¨6ç§æ¨¡æ¿ï¼š

| å¸§æ•° | å§¿åŠ¿åç§° | åŠ¨ä½œæè¿° | AIæç¤ºè¯­ |
|------|----------|----------|----------|
| **ç¬¬1å¸§** | Starting pose | ä¸­æ€§èµ·å§‹å§¿åŠ¿ | "Character in neutral starting position, standing upright with natural posture" |
| **ç¬¬2å¸§** | Initial movement | å¼€å§‹ç§»åŠ¨ | "Character beginning to move, slight shift in weight or position" |
| **ç¬¬3å¸§** | Mid action pose | åŠ¨ä½œä¸­æ®µ | "Character in the middle of movement, showing progression" |
| **ç¬¬4å¸§** | Peak action | åŠ¨ä½œé¡¶å³° | "Character at peak of movement or maximum expression" |
| **ç¬¬5å¸§** | Recovery position | æ¢å¤å§¿åŠ¿ | "Character recovering, moving back toward starting position" |
| **ç¬¬6å¸§** | Final pose | æœ€ç»ˆå§¿åŠ¿ | "Character in final position of the sequence" |
| **ç¬¬7å¸§** | Starting pose (Variation 2) | èµ·å§‹å§¿åŠ¿å˜åŒ–2 | "Character in neutral starting position, standing upright with natural posture, variation 2" |
| **ç¬¬8å¸§** | Initial movement (Variation 2) | å¼€å§‹ç§»åŠ¨å˜åŒ–2 | "Character beginning to move, slight shift in weight or position, variation 2" |
| **ç¬¬9å¸§** | Mid action pose (Variation 2) | åŠ¨ä½œä¸­æ®µå˜åŒ–2 | "Character in the middle of movement, showing progression, variation 2" |
| **ç¬¬10å¸§** | Peak action (Variation 2) | åŠ¨ä½œé¡¶å³°å˜åŒ–2 | "Character at peak of movement or maximum expression, variation 2" |
| **ç¬¬11å¸§** | Recovery position (Variation 2) | æ¢å¤å§¿åŠ¿å˜åŒ–2 | "Character recovering, moving back toward starting position, variation 2" |
| **ç¬¬12å¸§** | Final pose (Variation 2) | æœ€ç»ˆå§¿åŠ¿å˜åŒ–2 | "Character in final position of the sequence, variation 2" |

## ğŸ¯ å®é™…å›¾åƒç”Ÿæˆè¿‡ç¨‹

### ç¬¬1å¸§ç”Ÿæˆï¼š
```typescript
// AIæ”¶åˆ°çš„å®Œæ•´æç¤ºè¯
const prompt = `åŸºäºå‚è€ƒå›¾åƒï¼Œç”Ÿæˆç¬¦åˆä»¥ä¸‹å§¿åŠ¿æè¿°çš„é™æ­¢ç”»é¢å¸§ï¼š

å§¿åŠ¿æè¿°ï¼šCharacter in neutral starting position, standing upright with natural posture
åŠ¨ä½œæ­¥éª¤ï¼š1

è¦æ±‚ï¼š
- ä¸¥æ ¼éµå¾ªå‚è€ƒå›¾åƒä¸­è§’è‰²/ç‰©ä½“çš„åŸºæœ¬å¤–è§‚ã€æ¯”ä¾‹å’Œç‰¹å¾
- ç²¾ç¡®åº”ç”¨å§¿åŠ¿æè¿°ä¸­çš„åŠ¨ä½œè¦æ±‚
- ä¿æŒåŸå§‹å›¾åƒçš„å…‰ç…§æ¡ä»¶å’ŒèƒŒæ™¯å…ƒç´ 
- ç¡®ä¿åŠ¨ä½œè‡ªç„¶æµç•…ï¼Œé€‚åˆé€å¸§åŠ¨ç”»åˆ¶ä½œ
- ä¿æŒå›¾åƒè´¨é‡æ¸…æ™°ï¼Œé€‚åˆåœæ­¢åŠ¨ç”»åˆ¶ä½œ
- ä¿æŒé£æ ¼ä¸€è‡´æ€§ï¼šé¢œè‰²ã€çº¹ç†ã€æè´¨ç­‰ç»†èŠ‚

ç”Ÿæˆä¸€å¼ æ¸…æ´ã€å¯åˆ¶ä½œçš„é«˜è´¨é‡åŠ¨ç”»å¸§ï¼Œç²¾ç¡®åŒ¹é…å§¿åŠ¿æè¿°è¦æ±‚ã€‚`;

// è°ƒç”¨AIç”Ÿæˆ
const frame1 = await nanobanana(prompt, originalImageBuffer);
```

### ç¬¬2å¸§ç”Ÿæˆï¼š
```typescript
// AIæ”¶åˆ°çš„å®Œæ•´æç¤ºè¯
const prompt = `åŸºäºå‚è€ƒå›¾åƒï¼Œç”Ÿæˆç¬¦åˆä»¥ä¸‹å§¿åŠ¿æè¿°çš„é™æ­¢ç”»é¢å¸§ï¼š

å§¿åŠ¿æè¿°ï¼šCharacter beginning to move, slight shift in weight or position
åŠ¨ä½œæ­¥éª¤ï¼š2

è¦æ±‚ï¼š
- ä¸¥æ ¼éµå¾ªå‚è€ƒå›¾åƒä¸­è§’è‰²/ç‰©ä½“çš„åŸºæœ¬å¤–è§‚ã€æ¯”ä¾‹å’Œç‰¹å¾
- ç²¾ç¡®åº”ç”¨å§¿åŠ¿æè¿°ä¸­çš„åŠ¨ä½œè¦æ±‚
- ä¿æŒåŸå§‹å›¾åƒçš„å…‰ç…§æ¡ä»¶å’ŒèƒŒæ™¯å…ƒç´ 
- ç¡®ä¿åŠ¨ä½œè‡ªç„¶æµç•…ï¼Œé€‚åˆé€å¸§åŠ¨ç”»åˆ¶ä½œ
- ä¿æŒå›¾åƒè´¨é‡æ¸…æ™°ï¼Œé€‚åˆåœæ­¢åŠ¨ç”»åˆ¶ä½œ
- ä¿æŒé£æ ¼ä¸€è‡´æ€§ï¼šé¢œè‰²ã€çº¹ç†ã€æè´¨ç­‰ç»†èŠ‚

ç”Ÿæˆä¸€å¼ æ¸…æ´ã€å¯åˆ¶ä½œçš„é«˜è´¨é‡åŠ¨ç”»å¸§ï¼Œç²¾ç¡®åŒ¹é…å§¿åŠ¿æè¿°è¦æ±‚ã€‚`;

// è°ƒç”¨AIç”Ÿæˆ
const frame2 = await nanobanana(prompt, originalImageBuffer);
```

### ç¬¬3å¸§ç”Ÿæˆï¼š
```typescript
// AIæ”¶åˆ°çš„å®Œæ•´æç¤ºè¯
const prompt = `åŸºäºå‚è€ƒå›¾åƒï¼Œç”Ÿæˆç¬¦åˆä»¥ä¸‹å§¿åŠ¿æè¿°çš„é™æ­¢ç”»é¢å¸§ï¼š

å§¿åŠ¿æè¿°ï¼šCharacter in the middle of movement, showing progression
åŠ¨ä½œæ­¥éª¤ï¼š3

è¦æ±‚ï¼š
- ä¸¥æ ¼éµå¾ªå‚è€ƒå›¾åƒä¸­è§’è‰²/ç‰©ä½“çš„åŸºæœ¬å¤–è§‚ã€æ¯”ä¾‹å’Œç‰¹å¾
- ç²¾ç¡®åº”ç”¨å§¿åŠ¿æè¿°ä¸­çš„åŠ¨ä½œè¦æ±‚
- ä¿æŒåŸå§‹å›¾åƒçš„å…‰ç…§æ¡ä»¶å’ŒèƒŒæ™¯å…ƒç´ 
- ç¡®ä¿åŠ¨ä½œè‡ªç„¶æµç•…ï¼Œé€‚åˆé€å¸§åŠ¨ç”»åˆ¶ä½œ
- ä¿æŒå›¾åƒè´¨é‡æ¸…æ™°ï¼Œé€‚åˆåœæ­¢åŠ¨ç”»åˆ¶ä½œ
- ä¿æŒé£æ ¼ä¸€è‡´æ€§ï¼šé¢œè‰²ã€çº¹ç†ã€æè´¨ç­‰ç»†èŠ‚

ç”Ÿæˆä¸€å¼ æ¸…æ´ã€å¯åˆ¶ä½œçš„é«˜è´¨é‡åŠ¨ç”»å¸§ï¼Œç²¾ç¡®åŒ¹é…å§¿åŠ¿æè¿°è¦æ±‚ã€‚`;

// è°ƒç”¨AIç”Ÿæˆ
const frame3 = await nanobanana(prompt, originalImageBuffer);
```

## ğŸ­ åŠ¨ç”»æ•ˆæœç¤ºä¾‹

### å¦‚æœç”¨æˆ·ä¸Šä¼ çš„æ˜¯ï¼š
- **ä¸€ä¸ªç«™ç«‹çš„äººç‰©** â†’ ç”Ÿæˆäººç‰©èµ°è·¯ã€æŒ¥æ‰‹ã€è½¬èº«ç­‰åŠ¨ä½œ
- **ä¸€åªåŠ¨ç‰©** â†’ ç”ŸæˆåŠ¨ç‰©è·‘è·³ã€ä¼¸å±•ã€ç©è€ç­‰åŠ¨ä½œ
- **ä¸€ä¸ªç‰©ä½“** â†’ ç”Ÿæˆç‰©ä½“ç§»åŠ¨ã€æ—‹è½¬ã€å˜å½¢ç­‰åŠ¨ç”»
- **ä¸€ä¸ªè¡¨æƒ…** â†’ ç”Ÿæˆè¡¨æƒ…å˜åŒ–ã€çœ¨çœ¼ã€å¾®ç¬‘ç­‰å¾®è¡¨æƒ…

### å…¸å‹åŠ¨ç”»åºåˆ—ï¼š
```
åŸå§‹å›¾ç‰‡ï¼ˆç«™ç«‹çš„äººï¼‰
    â†“
ç¬¬1å¸§ï¼šä¸­æ€§ç«™å§¿ï¼ˆç¨å¾®æŒºç›´ï¼‰
ç¬¬2å¸§ï¼šå¼€å§‹åŠ¨ï¼ˆé‡å¿ƒè½»å¾®ç§»åŠ¨ï¼‰
ç¬¬3å¸§ï¼šåŠ¨ä½œä¸­æ®µï¼ˆèº«ä½“å‰å€¾ï¼‰
ç¬¬4å¸§ï¼šåŠ¨ä½œé¡¶å³°ï¼ˆæŠ¬æ‰‹/è¿ˆæ­¥ï¼‰
ç¬¬5å¸§ï¼šæ¢å¤ï¼ˆèº«ä½“å›æ”¶ï¼‰
ç¬¬6å¸§ï¼šç»“æŸå§¿åŠ¿ï¼ˆæ–°çš„ç¨³å®šçŠ¶æ€ï¼‰
ç¬¬7-12å¸§ï¼šé‡å¤çš„å˜ä½“åŠ¨ä½œ
```

## ğŸ›ï¸ å§¿åŠ¿è®¾è®¡çš„åŠ¨ç”»åŸç†

### 1. **èµ·æ‰¿è½¬åˆç»“æ„**
- **èµ· (Starting)**: å»ºç«‹åŸºå‡†çŠ¶æ€
- **æ‰¿ (Initial)**: å¼€å§‹å‘ç”Ÿå˜åŒ–
- **è½¬ (Mid-Peak)**: è¾¾åˆ°åŠ¨ä½œé«˜æ½®
- **åˆ (Recovery-Final)**: æ¢å¤ç¨³å®š

### 2. **åœæ ¼åŠ¨ç”»åŸåˆ™**
- **é¢„å¤‡åŠ¨ä½œ**: ç¬¬2å¸§è½»å¾®ç§»åŠ¨ï¼Œä¸ºå¤§åŠ¨ä½œåšå‡†å¤‡
- **ä¸»è¦åŠ¨ä½œ**: ç¬¬4å¸§æ˜¯è§†è§‰ç„¦ç‚¹
- **è·ŸéšåŠ¨ä½œ**: ç¬¬5å¸§è‡ªç„¶å›å¼¹
- **ç¼“å†²åŠ¨ä½œ**: ç¬¬6å¸§ç¨³å®šè¿‡æ¸¡

### 3. **èŠ‚å¥æ§åˆ¶**
```
å¸§é—´æ—¶é—´é—´éš” (å‡è®¾12fps):
1â†’2: å¿«é€Ÿ (å¯åŠ¨)
2â†’3: ä¸­ç­‰ (åŠ é€Ÿ)
3â†’4: æœ€å¿« (é«˜æ½®)
4â†’5: ä¸­ç­‰ (å‡é€Ÿ)
5â†’6: æ…¢é€Ÿ (ç¨³å®š)
```

## ğŸ”§ æŠ€æœ¯ä¼˜åŠ¿

### âœ… ä¼˜ç‚¹ï¼š
1. **æ ‡å‡†åŒ–åŠ¨ä½œ**: åŸºäºç»å…¸åŠ¨ç”»ç†è®ºï¼ŒåŠ¨ä½œæµç•…
2. **é€šç”¨æ€§å¼º**: é€‚ç”¨äºä»»ä½•ç±»å‹çš„å›¾åƒå†…å®¹
3. **å¯æ‰©å±•**: å¯ä»¥è½»æ¾æ·»åŠ æ–°çš„å§¿åŠ¿æ¨¡æ¿
4. **è‡ªåŠ¨åŒ–**: æ— éœ€ç”¨æˆ·æ‰‹åŠ¨å®šä¹‰æ¯ä¸ªåŠ¨ä½œ

### âŒ é™åˆ¶ï¼š
1. **é€šç”¨æ€§è¿‡å¼º**: ç¼ºä¹é’ˆå¯¹æ€§ï¼Œå¯èƒ½ä¸ç¬¦åˆç‰¹å®šè§’è‰²çš„ç‰¹æ€§
2. **å˜åŒ–æœ‰é™**: å¾ªç¯ä½¿ç”¨6ç§æ¨¡æ¿ï¼Œå®¹æ˜“é‡å¤
3. **è¯­ä¹‰æ¨¡ç³Š**: æç¤ºè¯ç›¸å¯¹æŠ½è±¡ï¼ŒAIç†è§£å¯èƒ½æœ‰åå·®

## ğŸš€ æ”¹è¿›å»ºè®®

### 1. **å†…å®¹æ„ŸçŸ¥çš„å§¿åŠ¿ç”Ÿæˆ**
```typescript
// æ ¹æ®å›¾ç‰‡å†…å®¹ç”Ÿæˆç›¸åº”çš„å§¿åŠ¿
if (imageContainsPerson) {
  poseTemplates = personPoses; // äººç‰©ä¸“ç”¨åŠ¨ä½œ
} else if (imageContainsAnimal) {
  poseTemplates = animalPoses; // åŠ¨ç‰©ä¸“ç”¨åŠ¨ä½œ
} else if (imageContainsObject) {
  poseTemplates = objectPoses; // ç‰©ä½“ä¸“ç”¨åŠ¨ä½œ
}
```

### 2. **æ™ºèƒ½åŠ¨ä½œæ¨è**
```typescript
// ä½¿ç”¨AIåˆ†æå›¾ç‰‡ï¼Œæ¨èåˆé€‚çš„åŠ¨ä½œç±»å‹
const actionRecommendations = await analyzeImageForActions(buffer);
const poseTemplates = generateCustomPoses(actionRecommendations);
```

### 3. **ç”¨æˆ·è‡ªå®šä¹‰å§¿åŠ¿**
```typescript
// å…è®¸ç”¨æˆ·è¾“å…¥è‡ªå·±çš„åŠ¨ä½œæè¿°
const customPoses = [
  { name: "æŒ¥æ‰‹", description: "Character waving hand" },
  { name: "è·³è·ƒ", description: "Character jumping up" },
  // ...ç”¨æˆ·å®šä¹‰çš„åŠ¨ä½œ
];
```

## ğŸ“Š æ€»ç»“

**"å§¿åŠ¿"æœ¬è´¨ä¸Šå°±æ˜¯ï¼š**
1. **ä¸åŒçš„AIæç¤ºè¯­**ï¼Œæè¿°ä¸åŒçš„åŠ¨ä½œçŠ¶æ€
2. **æŒ‰ç…§åœæ ¼åŠ¨ç”»åŸç†æ’åˆ—**ï¼Œå½¢æˆæµç•…çš„åŠ¨ç”»åºåˆ—
3. **å¾ªç¯ä½¿ç”¨æ¨¡æ¿**ï¼Œç¡®ä¿åŠ¨ä½œçš„ä¸€è‡´æ€§
4. **æ¯ä¸ªå§¿åŠ¿éƒ½ä¼šç”Ÿæˆä¸€å¼ å®Œæ•´çš„å›¾åƒ**ï¼Œä½œä¸ºåŠ¨ç”»çš„ä¸€å¸§

è¿™å°±æ˜¯ä¸ºä»€ä¹ˆç³»ç»Ÿèƒ½å¤Ÿå°†å•å¼ é™æ€å›¾ç‰‡è½¬æ¢ä¸ºè¿ç»­åŠ¨ç”»çš„æ ¸å¿ƒæœºåˆ¶ï¼